%                      Code_Saturne version 1.3
%                      ------------------------
%
%     This file is part of the Code_Saturne Kernel, element of the
%     Code_Saturne CFD tool.
% 
%     Copyright (C) 1998-2007 EDF S.A., France
%
%     contact: saturne-support@edf.fr
% 
%     The Code_Saturne Kernel is free software; you can redistribute it
%     and/or modify it under the terms of the GNU General Public License
%     as published by the Free Software Foundation; either version 2 of
%     the License, or (at your option) any later version.
% 
%     The Code_Saturne Kernel is distributed in the hope that it will be
%     useful, but WITHOUT ANY WARRANTY; without even the implied warranty
%     of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.
% 
%     You should have received a copy of the GNU General Public License
%     along with the Code_Saturne Kernel; if not, write to the
%     Free Software Foundation, Inc.,
%     51 Franklin St, Fifth Floor,
%     Boston, MA  02110-1301  USA
%
%-----------------------------------------------------------------------
%
\programme{cfbl**}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fonction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


On s'intéresse à la résolution des équations de Navier-Stokes en compressible,
en particulier pour des configurations sans choc. Le schéma global correspond à une 
extension des algorithmes volumes finis mis en \oe uvre pour simuler les 
équations de Navier-Stokes en incompressible.

Dans les grandes lignes, le sch\'ema est constitu\'e d'une \'etape
``acoustique'' fournissant la masse volumique (ainsi qu'une pr\'ediction de
pression et un d\'ebit acoustique), suivie de la r\'esolution de l'\'equation de
la quantit\'e de mouvement~; on r\'esout ensuite l'\'equation de l'\'energie 
et, pour terminer, la pression est mise \`a jour. 
Moyennant une contrainte sur la valeur du pas de temps, le sch\'ema permet 
d'assurer la positivit\'e de la masse volumique. 

La thermodynamique prise en compte \`a ce jour est celle des gaz parfaits, mais
l'organisation du code \`a \'et\'e  pr\'evue pour permettre \`a l'utilisateur de
fournir ses propres lois.  

Pour compléter la présentation, on pourra se reporter à la référence 
suivante~: \\
\textbf{[Mathon]} P. Mathon, F. Archambeau, J.-M. Hérard : "Implantation d'un 
algorithme compressible dans \CS", HI-83/03/016/A

Le cas de validation "tube \`a choc" de la version 1.2 de \CS\ permettra 
\'egalement d'apporter quelques compl\'ements (tube \`a choc de Sod, 
discontinuit\'e de contact instationnaire, double d\'etente sym\'etrique, 
double choc sym\'etrique). 

\newpage
%=================================
\subsection{Notations}
%=================================

\begin{table}[h!]
\begin{tabular}{ccp{10,5cm}}

{\bf Symbole} & {\bf Unit\'e} & {\bf Signification}\\

\phantom{$C_v$, ${C_v}_i$} & \phantom{$\lbrack f\rbrack.\,kg/(m^3.\,s)$} & \\

$C_p$, ${C_p}_i$ & $J/(kg.\,K)$	& capacité calorifique \`a pression constante
	$C_p = \left.\frac{\partial h}{\partial T}\right)_P$\\
$C_v$, ${C_v}_i$ & $J/(kg.\,K)$	& capacité calorifique \`a volume constant
	$C_v = \left.\frac{\partial \varepsilon}{\partial T}\right)_\rho$\\
$\mathcal{D}_{f/b}$ & $m^2/s$ 	& diffusivit\'e mol\'eculaire du composant $f$
					dans le bain\\
$E$ 		& $J/m^3$	& \'energie totale volumique $E = \rho e$\\
$F$ 		& 	 	& centre de gravit\'e d'une face\\
$H$ 		& $J/kg$ 	& enthalpie totale massique 
					$H = \frac{E+P}{\rho}$\\
$I$ 		& 	 	& point de co-location de la cellule $i$\\
$I'$ 		& 	 	& pour une face $ij$ partag\'ee entre les 
					cellules $i$ et $j$, $I'$ 
					est le projet\'e de $I$ sur la 
					normale \`a la $ij$ passant 
					par $F$, centre de $ij$\\
$K$ 		& $kg/(m.\,s)$ 	& diffusivit\'e thermique\\
$M$, $M_i$ 	& $kg/mol$ 	& masse molaire ($M_i$ pour le constituant $i$)\\
$P$ 		& $Pa$ 		& pression\\
$\vect{Q}$ 	& $kg/(m^2.\,s)$& vecteur quantit\'e de mouvement 
					$\vect{Q} = \rho\vect{u}$\\
$\vect{Q}_{ac}$ & $kg/(m^2.\,s)$& vecteur quantit\'e de mouvement issu 
					de l'\'etape acoustique\\
$Q$ 		& $kg/(m^2.\,s)$& norme de $\vect{Q}$\\
$R$ 		& $J/(mol.\,K)$ & constante universelle des gaz parfaits\\
$S$ 		& $J/(K.\,m^3)$	& entropie volumique\\
$\mathcal{S}$ 	& $\lbrack f\rbrack.\,kg/(m^3.\,s)$
				& Terme de production/dissipation volumique 
					pour le scalaire $f$\\
$T$ 		& $K$ 		& temp\'erature ($>0$)\\
$Y_i$ 		& 		& fraction massique du compos\'e $i$ 
					($0 \leqslant Y_i \leqslant 1$)\\
\end{tabular}
\end{table}

\clearpage 

\begin{table}[htp]
\begin{tabular}{ccp{10,5cm}}

{\bf Symbole} & {\bf Unit\'e} & {\bf Signification}\\

\phantom{$C_v$, ${C_v}_i$} & \phantom{$\lbrack f\rbrack.\,kg/(m^3.\,s)$} & \\

$c^2$ 		& $(m/s)^2$ 	& carr\'e de la vitesse du son
		$c^2 = \left.\frac{\partial P}{\partial \rho}\right)_s$\\
$e$ 		& $J/kg$ 	& \'energie totale massique 
					$e = \varepsilon + \frac{1}{2}u^2$\\
$\vect{f}_v$ 	& $N/kg$ 	& $\rho\vect{f}_v$ repr\'esente le terme 
					source volumique pour la quantit\'e
					de mouvement~: gravit\'e, pertes 
					de charges, tenseurs des contraintes
					turbulentes, forces de Laplace...\\
$\vect{g}$ 	& $m/s^2$ 	& acc\'el\'eration de la pesanteur\\
$h$ 		& $J/kg$ 	& enthalpie massique 
					$h=\varepsilon + \frac{P}{\rho}$\\
$i$ 		&  		& indice faisant r\'ef\'erence \`a la 
					cellule $i$~; $f_i$ est la valeur 
					de la variable $f$ associ\'ee 
					au point de co-location $I$\\
$I'$ 		&  		& indice faisant r\'ef\'erence \`a la 
					cellule $i$~; $f_I'$ est la valeur 
					de la variable $f$ associ\'ee 
					au point $I'$\\
$\vect{j}\wedge\vect{B}$ 
		& $N/m^3$ 	& forces de Laplace\\
$r$, $r_i$ 	& $J/(kg.\,K)$ 	& constante massique des gaz parfaits 
					$r = \frac{R}{M}$
					(pour le constituant $i$, on a $r_i=\frac{R}{M_i}$)\\
$s$ 		& $J/(K.\,kg)$ 	& entropie massique\\
$t$ 		& $s$ 		& temps\\
$\vect{u}$ 	& $m/s$ 	& vecteur vitesse\\
$u$ 		& $m/s$ 	& norme de $\vect{u}$\\

\end{tabular}
\end{table}


\newpage 

\begin{table}[htp]
\begin{tabular}{ccp{10,5cm}}

{\bf Symbole} & {\bf Unit\'e} & {\bf Signification}\\

\phantom{$C_v$, ${C_v}_i$} & \phantom{$\lbrack f\rbrack.\,kg/(m^3.\,s)$} & \\

$\beta$ 	& $kg/(m^3.\,K)$ & 
	$\beta = \left.\frac{\partial P}{\partial s}\right)_\rho$\\
$\gamma$ 	& $kg/(m^3.\,K)$ & constante caract\'eristique 
					d'un gaz parfait 
					$\gamma = \frac{C_p}{C_v}$\\
$\varepsilon$ 	& $J/kg$ 	& \'energie interne massique\\
$\kappa$ 	& $kg/(m.\,s)$ 	& viscosit\'e dynamique en volume\\
$\lambda$ 	& $W/(m.\,K)$ 	& conductivit\'e thermique\\
$\mu$	 	& $kg/(m.\,s)$ 	& viscosit\'e dynamique ordinaire\\
$\rho$ 		& $kg/m^3$ 	& densit\'e\\
$\vect{\varphi}_f$ 
		& $\lbrack f\rbrack.\,kg/(m^2.\,s)$ 		
				& vecteur flux diffusif du compos\'e $f$\\
$\varphi_f$ 	& $\lbrack f\rbrack.\,kg/(m^2.\,s)$ 
				& norme de $\vect{\varphi}_f$\\

\phantom{ouden}	& 		& \\

$\tens{\Sigma}^v$ &$kg/(m^2.\,s^2)$& tenseur des contraintes visqueuses\\
$\vect{\Phi}_s$ & $W/m^2$	& vecteur flux conductif de chaleur\\
$\Phi_s$ 	& $W/m^2$ 	& norme de $\vect{\Phi}_s$\\
$\Phi_v$ 	& $W/kg$ 	& $\rho\Phi_v$ repr\'esente le terme 
					source volumique d'\'energie, 
					comprenant par exemple 
					l'effet Joule $\vect{j}\cdot\vect{E}$,
					le rayonnement...\\
\end{tabular}
\end{table}
\clearpage

%=================================
\subsection{Syst\`eme d'\'equations laminaires de r\'ef\'erence}
%=================================

L'algorithme d\'evelopp\'e propose de r\'esoudre
l'\'equation de continuit\'e, les \'equations de Navier-Stokes
ainsi que l'\'equation d'\'energie totale de mani\`ere conservative,
pour des \'ecoulements compressibles.

\begin{equation}\label{Cfbl_Cfbase_eq_ref_laminaire_cfbase}
\left\{\begin{array}{l}

\displaystyle\frac{\partial\rho}{\partial t} + \divs(\vect{Q}) = 0 \\
\\
\displaystyle\frac{\partial\vect{Q}}{\partial t}
+ \divv(\vect{u} \otimes \vect{Q}) + \gradv{P}
= \rho \vect{f}_v + \divv(\tens{\Sigma}^v) \\
\\
\displaystyle\frac{\partial E}{\partial t} + \divs( \vect{u} (E+P) )
= \rho\vect{f}_v\cdot\vect{u} + \divs(\tens{\Sigma}^v \vect{u})
- \divs{\,\vect{\Phi}_s} + \rho\Phi_v

\end{array}\right.
\end{equation}

Nous avons présenté ici le système d'équations laminaires, mais il faut préciser
que la turbulence ne pose pas de problème particulier dans la mesure où les 
équations suppl\'ementaires sont découplées du syst\`eme~(\ref{Cfbl_Cfbase_eq_ref_laminaire_cfbase}).  

%=================================
\subsection{Expression des termes intervenant dans les \'equations}
%=================================

\begin{itemize}

\item{\'Energie totale volumique :
	\begin{equation}
	E = \rho e = \rho\varepsilon + \frac{1}{2} \rho u^2
	\end{equation}
	avec l'\'energie interne $\varepsilon(P,\rho)$ donn\'ee par l'\'equation d'\'etat}
\\
\item{Forces volumiques : $\rho\vect{f}_v$ (dans la plupart des cas 
                                            $\rho\vect{f}_v= \rho\vect{g}$)}
\\
\item{Tenseur des contraintes visqueuses pour un fluide Newtonien :
	\begin{equation}
	\tens{\Sigma}^v = \mu (\gradt{\vect{u}} +\ ^t\gradt{\vect{u}})
	+ (\kappa - \frac{2}{3}\mu) \divs\,{\vect{u}}\ \tens{Id}
	\end{equation}
	avec $\mu(T,\ldots)$ et $\kappa(T,\ldots)$ mais souvent $\kappa =0$}
\\
\item{Flux de conduction de la chaleur : loi de Fourier
	\begin{equation}
	\vect{\Phi}_s = -\lambda \gradv{T}
	\end{equation}
	avec $\lambda(T,\ldots)$} 
\\
\item{Source de chaleur volumique : $\rho\Phi_v$}

\end{itemize}


%=================================
\subsection{\'Equations d'\'etat et expressions de l'\'energie interne}
\label{Cfbl_Cfbase_equations_etat_cfbase}
%=================================

%---------------------------------
\subsubsection{Gaz parfait}
%---------------------------------

\'Equation d'\'etat : $P = \rho r T$\\


\'Energie interne massique :
$\varepsilon = \displaystyle\frac{P}{(\gamma -1) \rho}$

Soit~: 
\begin{equation}\label{Cfbl_Cfbase_eq_pression_gp_cfbase}
P = (\gamma -1) \rho (e - \frac{1}{2} u^2)
\end{equation}


%---------------------------------
\subsubsection{M\'elange de gaz parfaits}
%---------------------------------

On consid\`ere un m\'elange de $N$ constituants de fractions massiques
$(Y_i)_{i=1 \ldots N}$\\

\'Equation d'\'etat : $P = \rho\ r_{m\acute elange}\ T$\\

\'Energie interne massique :
$\varepsilon = \displaystyle\frac{P}{(\gamma_{m\acute elange} -1)\rho}$

Soit~:
\begin{equation}\label{Cfbl_Cfbase_eq_pression_melange_gp_cfbase}
P = (\gamma_{m\acute elange} -1) \rho (e - \frac{1}{2} u^2)
\end{equation}

avec $\gamma_{m\acute elange}
= \displaystyle\frac{\sum\limits_{i=1}^{N} {Y_i C_{pi}}}
{\sum\limits_{i=1}^{N} {Y_i C_{vi}}}$\ \ 
et\ \ $r_{m\acute elange} = \displaystyle\sum\limits_{i=1}^{N} {Y_i r_i}$


%---------------------------------
\subsubsection{Equation d'\'etat de Van der Waals}
%---------------------------------

Cette \'equation est une correction de l'\'equation d'\'etat
des gaz parfaits pour tenir compte des forces intermol\'eculaires
et du volume des mol\'ecules constitutives du gaz.
On introduit deux coefficients correctifs~:
$a$ [$Pa.\,m^6 / kg^2$] est li\'e aux forces intermol\'eculaires 
et $b$ [$m^3/kg$] est le covolume (volume occup\'e par les mol\'ecules).\\

\'Equation d'\'etat : $(P+a\rho^2)(1-b\rho) = \rho r T$\\

\'Energie interne massique :
$\varepsilon = \displaystyle\frac{(P+a\rho^2)(1-b\rho)}
{(\hat{\gamma} -1)\rho} - a \rho$

Soit~: 
\begin{equation}\label{Cfbl_Cfbase_eq_pression_vdw_cfbase}
P = (\hat{\gamma} -1) \displaystyle\frac{\rho}{(1-b\rho)}
(e - \frac{1}{2} u^2 + a\rho) - a \rho^2
\end{equation}

avec $\hat{\gamma} = 1 + \displaystyle\frac{r}{C_v}
= \displaystyle\frac{C_p}{C_v}
\displaystyle\left(\frac{P-a\rho^2 (1-2b\rho)}{P+a\rho^2}\right)
+ \displaystyle\frac{2a\rho^2 (1-b\rho)}{P+a\rho^2}$



%=================================
\subsection{Calcul des grandeurs thermodymamiques}
%=================================

%---------------------------------
\subsubsection{Pour un gaz parfait \`a $\gamma$ constant}
%---------------------------------

%`````````````````````````````````
\paragraph{Equation d'\'etat~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$P = \rho r T$

On suppose connues la chaleur massique \`a pression constante $C_p$
et la masse molaire $M$ du gaz, ainsi que les variables d'\'etat.

%`````````````````````````````````
\paragraph{Chaleur massique \`a volume constant~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$C_v = C_p - \displaystyle\frac{R}{M} = C_p - r$


%`````````````````````````````````
\paragraph{Constante caract\'eristique du gaz~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$\gamma = \displaystyle\frac{C_p}{C_v} = \displaystyle\frac{C_p}{C_p - r}$


%`````````````````````````````````
\paragraph{Vitesse du son~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$c^2 = \gamma \displaystyle\frac{P}{\rho}$


%`````````````````````````````````
\paragraph{Entropie~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$s = \displaystyle\frac{P}{\rho^{\gamma}}$
\quad et
$\beta = \left.\displaystyle\frac{\partial P}{\partial s}\right)_{\rho}
= \rho^{\gamma}$

\noindent\textit{Remarque~:} L'entropie choisie ici n'est pas l'entropie
physique, mais une entropie math\'ematique qui v\'erifie \quad
$c^2 \left.\displaystyle\frac{\partial s}{\partial P}\right)_{\rho}
+ \left.\displaystyle\frac{\partial s}{\partial \rho}\right)_{P} = 0$


%`````````````````````````````````
\paragraph{Pression~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$P = (\gamma-1) \rho \varepsilon$


%`````````````````````````````````
\paragraph{Energie interne~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$\varepsilon = C_v T
= \displaystyle\frac{1}{\gamma-1} \displaystyle\frac{P}{\rho}$\qquad\text{\ \ avec\ \ }
$\varepsilon_{sup} = 0$

%`````````````````````````````````
\paragraph{Enthalpie~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$h = C_p T
= \displaystyle\frac{\gamma}{\gamma-1} \displaystyle\frac{P}{\rho}$


%---------------------------------
\subsubsection{Pour un m\'elange de gaz parfaits}
%---------------------------------

Une intervention de l'utilisateur dans le sous-programme utilisateur 
\fort{uscfth} est nécessaire pour pouvoir utiliser ces lois.

%`````````````````````````````````
\paragraph{Equation d'\'etat~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$P = \rho\ r_{m\acute el}\ T$
\quad avec $r_{m\acute el} = \displaystyle\sum\limits_{i=1}^{N} {Y_i r_i}
= \displaystyle\sum\limits_{i=1}^{N} Y_i \displaystyle\frac{R}{M_i}$


On suppose connues la chaleur massique \`a pression constante
des diff\'erents constituants ${C_p}_i$,
la masse molaire $M_i$ des constituants du gaz,
ainsi que les variables d'\'etat (dont les fractions massiques $Y_i$).

%`````````````````````````````````
\paragraph{Masse molaire du m\'elange~:} 
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$M_{m\acute el} = \left(\displaystyle\sum\limits_{i=1}^{N}
\displaystyle\frac{Y_i}{M_i} \right)^{-1}$

%`````````````````````````````````
\paragraph{Chaleur massique \`a pression constante du m\'elange~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
$\\$
${C_p}_{m\acute el} = \displaystyle\sum\limits_{i=1}^{N} Y_i {C_p}_i$


%`````````````````````````````````
\paragraph{Chaleur massique \`a volume constant du m\'elange~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
$\\$
${C_v}_{m\acute el} = \displaystyle\sum\limits_{i=1}^{N} Y_i {C_v}_i
= {C_p}_{m\acute el} - \displaystyle\frac{R}{M_{m\acute el}}
= {C_p}_{m\acute el} - r_{m\acute el}$


%`````````````````````````````````
\paragraph{Constante caract\'eristique du gaz~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$\gamma_{m\acute el} = \displaystyle\frac{{C_p}_{m\acute el}}
{{C_v}_{m\acute el}}
= \displaystyle\frac{{C_p}_{m\acute el}}{{C_p}_{m\acute el} - r_{m\acute el}}$


%`````````````````````````````````
\paragraph{Vitesse du son~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$c^2 = \gamma_{m\acute el} \displaystyle\frac{P}{\rho}$


%`````````````````````````````````
\paragraph{Entropie~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$s = \displaystyle\frac{P}{\rho^{\gamma_{m\acute el}}}$
\quad et
$\beta = \left.\displaystyle\frac{\partial P}{\partial s}\right)_{\rho}
= \rho^{\gamma_{m\acute el}}$


%`````````````````````````````````
\paragraph{Pression~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$P = (\gamma_{m\acute el}-1) \rho \varepsilon$


%`````````````````````````````````
\paragraph{Energie interne~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$\varepsilon = {C_v}_{m\acute el}\ T$\qquad\text{\ \ avec\ \ }
$\varepsilon_{sup} = 0$


%`````````````````````````````````
\paragraph{Enthalpie~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$h = {C_p}_{m\acute el}\  T
= \displaystyle\frac{\gamma_{m\acute el}}{\gamma_{m\acute el}-1}
\displaystyle\frac{P}{\rho}$

%---------------------------------
\subsubsection{Pour un gaz de Van der Waals}
%---------------------------------

Ces lois n'ont pas été programmées, mais l'utilisateur peut intervenir
dans le sous-programme utilisateur \fort{uscfth} s'il souhaite le faire.

%`````````````````````````````````
\paragraph{Equation d'\'etat~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$(P+a\rho^2)(1-b\rho) = \rho r T$

avec $a$ [$Pa.\,m^6 / kg^2$] li\'e aux forces intermol\'eculaires 
et $b$ [$m^3/kg$] le covolume (volume occup\'e par les mol\'ecules).

On suppose connus les coefficients $a$ et $b$, 
la chaleur massique \`a pression constante $C_p$,
la masse molaire $M$ du gaz et 
les variables d'\'etat.


%`````````````````````````````````
\paragraph{Chaleur massique \`a volume constant~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$C_v = C_p - r
\displaystyle\frac{P+a\rho^2}{P-a\rho^2 (1-2b\rho)}$


%`````````````````````````````````
\paragraph{Constante ``\'equivalente'' du gaz~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$\hat{\gamma} = 1 + \displaystyle\frac{r}{C_v}
= \displaystyle\frac{C_p}{C_v}
\displaystyle\left(\frac{P-a\rho^2 (1-2b\rho)}{P+a\rho^2}\right)
+ \displaystyle\frac{2a\rho^2 (1-b\rho)}{P+a\rho^2}$

%`````````````````````````````````
\paragraph{Vitesse du son~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$c^2 = \hat{\gamma} \displaystyle\frac{P+a\rho^2}{\rho(1-b\rho)} - 2a\rho$


%`````````````````````````````````
\paragraph{Entropie~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$s = (P+a\rho^2)
\left(\displaystyle\frac{1-b\rho}{\rho}\right)^{\hat{\gamma}}$
\quad et
$\beta = \left.\displaystyle\frac{\partial P}{\partial s}\right)_{\rho}
= \left(\displaystyle\frac{\rho}{1-b\rho}\right)^{\hat{\gamma}}$


%`````````````````````````````````
\paragraph{Pression~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$P = (\hat{\gamma} -1) \displaystyle\frac{\rho}{(1-b\rho)}
(\varepsilon + a\rho) - a \rho^2$

%`````````````````````````````````
\paragraph{Energie interne~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$\varepsilon = C_v T - a \rho$\qquad\text{\ \ avec\ \ }
$\varepsilon_{sup} = - a \rho$


%`````````````````````````````````
\paragraph{Enthalpie~:}
%,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,

$h = \displaystyle\frac{\hat{\gamma}-b\rho}{\hat{\gamma}-1}
 \displaystyle\frac{P+a\rho^2}{\rho} - 2a\rho$


%=================================
\subsection{Algorithme de base}
%=================================

On suppose connues toutes les variables au temps $t^n$ et on cherche
\`a les d\'eterminer \`a l'instant $t^{n+1}$.
On r\'esout en deux blocs principaux~: d'une part le syst\`eme masse-quantit\'e
de mouvement, de l'autre l'\'equation portant sur l'\'energie et les scalaires
transport\'es.
Dans le premier bloc, on distingue le traitement du syst\`eme (coupl\'e)
acoustique et le traitement de l'\'equation de la quantit\'e de mouvement
compl\`ete. 

Au d\'ebut du pas de temps, on commence par mettre \`a jour
les propri\'et\'es physiques variables (par exemple $\mu(T)$, $\kappa(T)$,
$C_p(Y_1,\ldots ,Y_N)$ ou $\lambda(T)$), puis on
r\'esout les \'etapes suivantes~:

\begin{enumerate}

  \item {\bf Acoustique~: sous-programme \fort{cfmsvl}} \\
     Résolution d'une équation de convection-diffusion portant sur $\rho^{n+1}$.\\
     On obtient à la fin de l'étape $\rho^{n+1}$, $Q^{n+1}_{ac}$ et 
éventuellement une
pr\'ediction de la pression $P^{pred}(\rho^{n+1},e^{n})$.\\
    
  \item {\bf Quantit\'e de mouvement~: sous-programme \fort{cfqdmv}}\\
     Résolution d'une équation de convection-diffusion portant sur $u^{n+1}$ qui
     fait intervenir  $Q^{n+1}_{ac}$ et $P^{pred}$.\\
     On obtient à la fin de l'étape $u^{n+1}$.\\ 

  \item {\bf \'Energie totale~: sous-programme \fort{cfener}}\\
     Résolution d'une équation de convection-diffusion portant sur $e^{n+1}$ qui
     fait intervenir  $Q^{n+1}_{ac}$, $P^{pred}$ et  $u^{n+1}$.\\
     On obtient \`a la fin de l'étape $e^{n+1}$ et une valeur actualisée de la
pression $P(\rho^{n+1},e^{n+1})$.\\ 

  \item {\bf Scalaires passifs}\\
     Résolution d'une équation de convection-diffusion standard par     
     scalaire, avec  $Q^{n+1}_{ac}$ pour flux convectif.
\end{enumerate}





