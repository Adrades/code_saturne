%                      Code_Saturne version 1.3
%                      ------------------------
%
%     This file is part of the Code_Saturne Kernel, element of the
%     Code_Saturne CFD tool.
%
%     Copyright (C) 1998-2007 EDF S.A., France
%
%     contact: saturne-support@edf.fr
%
%     The Code_Saturne Kernel is free software; you can redistribute it
%     and/or modify it under the terms of the GNU General Public License
%     as published by the Free Software Foundation; either version 2 of
%     the License, or (at your option) any later version.
%
%     The Code_Saturne Kernel is distributed in the hope that it will be
%     useful, but WITHOUT ANY WARRANTY; without even the implied warranty
%     of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.
%
%     You should have received a copy of the GNU General Public License
%     along with the Code_Saturne Kernel; if not, write to the
%     Free Software Foundation, Inc.,
%     51 Franklin St, Fifth Floor,
%     Boston, MA  02110-1301  USA
%
%-----------------------------------------------------------------------
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mise en \oe uvre}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Apr\`es une \'etape de gestion de la m\'emoire (\fort{memcfe}), on calcule les
diff\'erents termes sources (au centre des cellules)~:
\begin{itemize}
\item source volumique de chaleur (\fort{ustssc}),
\item source associ\'ee aux sources de masse (\fort{catsma}),
\item source associ\'ee \`a l'accumulation de masse $\dive\,\vect{Q}_{ac}$ (directement dans \fort{cfener}),
\item dissipation visqueuse (\fort{cfdivs}),
\item transport de pression (directement dans \fort{cfener}),
\item puissance de la pesanteur (directement dans \fort{cfener}),
\item termes diffusifs en $\displaystyle\dive\left(K\,\grad\left(\frac{1}{2} u^2 +
\varepsilon_{sup}\right)\right)$ (calcul de $\varepsilon_{sup}$ par
\fort{uscfth}, puis calcul du terme diffusif directement dans \fort{cfener}).
\end{itemize}

\bigskip
Le syst\`eme (\ref{Cfbl_Cfener_eq_energie_totale_discrete_cfener}) est r\'esolu par une m\'ethode
d'incr\'ement et r\'esidu  en utilisant une m\'ethode de Jacobi (\fort{cfcdts}).

L'impression des bornes et
la limitation \'eventuelle de l'\'energie sont ensuite effectu\'ees par
\fort{clpsca} suivi de \fort{uscfth} (intervention utilisateur optionnelle).

On actualise enfin la pression et on calcule la
temp\'erature (\fort{uscfth}).

Pour
terminer, en parall\`ele ou en p\'eriodique, on \'echange les variables
pression, \'energie et temp\'erature.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Points \`a traiter}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% propose en patch 1.2.1

%Corriger \fort{cfener} dans lequel \var{W1} produit par \fort{uscfth} est
%\'ecras\'e par \fort{grdcel}, causant probablement des d\'eg\^ats
%dans les cas o\`u le gradient de l'\'energie cin\'etique dans la direction $x$
%est sensiblement non nul sur des faces de bord dont la normale a une
%composante en $x$ et lorsque la conductivit\'e n'est pas n\'egligeable.


\etape{Choix de $\widetilde{P}$}
En standard, on utilise $\widetilde{P}=P^n$, mais ce n'est pas le seul choix
possible. On pourrait étudier le comportement de l'algorithme avec $P^{Pred}$ et
$P^{n+1}$ (avec $P^{n+1}$, en particulier,
$\displaystyle\frac{\widetilde{P}}{\rho^{n+1}}$
est évalué avec la masse volumique et l'énergie prises au même instant).

\etape{Terme source dans l'équation de l'énergie}
La présence d'un terme source externe dans l'équation de l'énergie génère des
oscillations de vitesse qu'il est important d'analyser et de comprendre.